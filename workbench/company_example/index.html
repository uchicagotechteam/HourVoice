<!DOCTYPE html>
<html lang="en">
<head>
	<title>Company Index</title>
	<meta charset="utf-8">

	
	<link rel="stylesheet" type="text/css" href="reset.css">
	<link rel="stylesheet" type="text/css" href="main.css">
	<link rel="stylesheet" type="text/css" href="animate.css">
	

	<link rel="stylesheet" href="https://unpkg.com/leaflet@1.2.0/dist/leaflet.css"
   integrity="sha512-M2wvCLH6DSRazYeZRIm1JnYyh22purTM+FDB5CsyxtQJYeKq83arPe5wgbNmcFXGqiSH2XR8dT/fJISVA1r/zQ=="
   crossorigin=""/>
   <script src="https://unpkg.com/leaflet@1.2.0/dist/leaflet.js"
   integrity="sha512-lInM/apFSqyy1o6s89K4iQUKg6ppXEgsVxT35HbzUupEVRh2Eu9Wdl4tHj7dZO0s1uvplcYGmt3498TtHq+log=="
   crossorigin=""></script>
   <script src="https://d3js.org/d3.v4.min.js"></script>

	<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script> 

</head>
<body>

	<header class="wrapper dark">
		<div class="company">
			<h2 id="company_name">Company Name</h2>
		</div>
		<nav>
			<ul>
				<li><a href="">About Us</a></li>
				<li><a href="">Watchlist</a></li>
				<li><a href="">Submit Insights</a></li>
				<li><a href="">Contact Us</a></li>
			</ul>
		</nav>
	</header>


	<section class="basic wrapper">
		<div class="title animated wow fadeIn">
			<h2>About the Company</h2>
		</div>
		<div class="info">
			<h4>Address</h4>
			<p id="address">hello</p>
			<h4>Industry</h4>
			<p id="industry">hello</p>
			<h4>Business License ID</h4>
			<p id="license-id">hello</p>
			<h4>Manager</h4>
			<p id="owner">hello</p>
		</div>
	</section>


	<section class="services wrapper">
		<h2>Company Data</h2>
		<ul class="clearfix">
			<li class="animated wow fadeInDown">
				<div id="mapid"></div>
				<script>
					var companies = 'http://stopwagetheft.stanford.edu/api/v1/cases?&limit=1&columns=employees_owed_backwages,legal_name,latitude,longitude';
					var latitude = 0;
					var longitude = 0;
					
					$.getJSON(companies, function(data) {
						latitude = data["data"][0].latitude;
						longitude=data["data"][0].longitude;
					}).done(function(data) {
						var mymap = L.map('mapid').setView([latitude, longitude], 13);

						L.tileLayer('https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token=pk.eyJ1IjoiYXJueXplbmciLCJhIjoiY2phMDExaDByMzA1MzJwcG85ZWtoMHBwbCJ9.-PFtNi2OogmhDDJyveEXbA', {
						    attribution: 'Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, <a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery Â© <a href="http://mapbox.com">Mapbox</a>',
						    maxZoom: 18,
						    id: 'mapbox.streets',
						    accessToken: 'pk.eyJ1IjoiYXJueXplbmciLCJhIjoiY2phMDExaDByMzA1MzJwcG85ZWtoMHBwbCJ9.-PFtNi2OogmhDDJyveEXbA'
						}).addTo(mymap);

						var circle = L.circle([latitude, longitude], {
						    color: 'red',
						    fillColor: '#f03',
						    fillOpacity: 0.5,
						    radius: 200
						}).addTo(mymap);
					});
				</script>
				<span class="separator"></span>
				<h2>Location</h2>
			</li>
			<li class="animated wow fadeInDown"  data-wow-delay=".2s">
				<div id ="rating"></div>
				<script>
					var data = [
					  {name: "1", value: 40},
					  {name: "2", value: 20},
					  {name: "3", value: 30},
					  {name: "4", value: 10},
					  {name: "5", value: 9}
					];
					var text = "";

					var width = 260;
					var height = 260;
					var thickness = 40;
					var duration = 750;

					var radius = Math.min(width, height) / 2;
					var color = d3.scaleOrdinal(d3.schemeCategory20);

					var svg = d3.select("#rating")
					.append('svg')
					.attr('class', 'pie')
					.attr('width', width)
					.attr('height', height);

					var g = svg.append('g')
					.attr('transform', 'translate(' + (width/2) + ',' + (height/2) + ')');

					var arc = d3.arc()
					.innerRadius(radius - thickness)
					.outerRadius(radius);

					var pie = d3.pie()
					.value(function(d) { return d.value; })
					.sort(null);

					var path = g.selectAll('path')
					.data(pie(data))
					.enter()
					.append("g")
					.on("mouseover", function(d) {
					      let g = d3.select(this)
					        .style("cursor", "pointer")
					        .style("fill", "black")
					        .append("g")
					        .attr("class", "text-group");
					 
					      g.append("text")
					        .attr("class", "name-text")
					        .text(`${d.data.name}`)
					        .attr('text-anchor', 'middle')
					        .attr('dy', '-1.2em');
					  
					      g.append("text")
					        .attr("class", "value-text")
					        .text(`${d.data.value}`)
					        .attr('text-anchor', 'middle')
					        .attr('dy', '.6em');
					    })
					  .on("mouseout", function(d) {
					      d3.select(this)
					        .style("cursor", "none")  
					        .style("fill", color(this._current))
					        .select(".text-group").remove();
					    })
					  .append('path')
					  .attr('d', arc)
					  .attr('fill', (d,i) => color(i))
					  .on("mouseover", function(d) {
					      d3.select(this)     
					        .style("cursor", "pointer")
					        .style("fill", "white");
					    })
					  .on("mouseout", function(d) {
					      d3.select(this)
					        .style("cursor", "none")  
					        .style("fill", color(this._current));
					    })
					  .each(function(d, i) { this._current = i; });


					g.append('text')
					  .attr('text-anchor', 'middle')
					  .attr('dy', '.35em')
					  .text(text);
				</script>
				<span class="separator"></span>
				<h2>Rating</h2>
			</li>
			<li class="animated wow fadeInDown"  data-wow-delay=".4s">
				<div id="another-chart"></div>
				<script>
				</script>
				<span class="separator"></span>
				<h2>Another chart</h2>
			</li>
		</ul>
	</section>

	<script>
		window.onload = function() {
			var url = document.location.href,
        	params = url.split('?')[1].split('=');
        	url = params[1];
        	var name = "";
        	for (i=0; i<url.length; i++) {
        		if (url[i] == '_') {
        			name += " ";
        		} else {
        			name += url[i];
        		}
        	}
        	document.getElementById('company_name').innerHTML = name;
        	console.log(name)
		}
	</script>


	<section class="testimonials wrapper">
		<div class="title animated wow fadeIn">
			<h2>User Reviews</h2>
			<hr class="separator"/>
		</div>

		<ul class="clearfix">
			<li class="animated wow fadeInDown">
				<p>User Review #1
				</p>
			</li>
			<li class="animated wow fadeInDown"  data-wow-delay=".2s">
				<p>User Review #2
				</p>
			</li>
			<li class="animated wow fadeInDown"  data-wow-delay=".4s">
				<p>User Review #3
				</p>
			</li>
		</ul>
	</section><!--  End testimonials  -->


	<footer>
		<div class="wrapper">
			<div class="rights">
				<p>HourVoice</p>
			</div>

			<nav>
				<ul>
					<li><a href="#">About</a></li>
					<li><a href="#">FAQ</a></li>
					<li><a href="#">Contact</a></li>
				</ul>
			</nav>
		</div>		
	</footer><!--  End footer  -->
</body>
</html>